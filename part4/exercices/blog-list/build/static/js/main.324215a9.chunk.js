(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(21),u=n.n(c),l=n(48),o=n(63),i=n(8),s=function(e,t){return{type:"SET_NOTIFICATION",data:{notification:e,error:t}}},m=n(71),f=n(39),p=n(65),d=n(6),E=n.n(d),b=n(12),v=n(24),h=n.n(v),g="/api/blogs",O=null,y={getAll:function(){return h.a.get(g).then((function(e){return e.data}))},create:function(){var e=Object(b.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.post(g,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="Bearer ".concat(e)},update:function(){var e=Object(b.a)(E.a.mark((function e(t,n){var a,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:O}},e.next=3,h.a.put("".concat(g,"/").concat(t),n,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(b.a)(E.a.mark((function e(t){var n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,h.a.delete("".concat(g,"/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),comment:function(){var e=Object(b.a)(E.a.mark((function e(t,n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("".concat(g,"/").concat(t,"/comments"),{comment:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},j=n(27),w=n(113),k=n(68),x=function(){var e=Object(a.useState)(""),t=Object(j.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),l=Object(j.a)(u,2),o=l[0],s=l[1],m=Object(a.useState)(""),f=Object(j.a)(m,2),p=f[0],d=f[1],v=Object(i.b)();return r.a.createElement("div",null,r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:function(e){var t;e.preventDefault(),v((t={title:n,author:o,url:p},function(){var e=Object(b.a)(E.a.mark((function e(n){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.create(t);case 2:a=e.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),c(""),s(""),d("")}},r.a.createElement(w.a.Group,null,r.a.createElement(w.a.Label,null,"title"),r.a.createElement(w.a.Control,{type:"text",value:n,name:"title",onChange:function(e){var t=e.target;return c(t.value)}}),r.a.createElement(w.a.Label,null,"author"),r.a.createElement(w.a.Control,{type:"text",value:o,name:"author",onChange:function(e){var t=e.target;return s(t.value)}}),r.a.createElement(w.a.Label,null,"url"),r.a.createElement(w.a.Control,{type:"text",value:p,name:"url",onChange:function(e){var t=e.target;return d(t.value)}}),r.a.createElement(k.a,{variant:"primary",type:"submit"},"create"))))},S=n(116),T=function(){var e=Object(i.c)((function(e){return e.notification})),t=e.notification,n=e.error?"danger":"success";return t?r.a.createElement(S.a,{variant:n},t):null},I={login:function(){var e=Object(b.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(e){return{type:"SET_USER",data:{user:e}}},L=function(){var e=Object(a.useState)(""),t=Object(j.a)(e,2),n=t[0],c=t[1],u=Object(a.useState)(""),l=Object(j.a)(u,2),o=l[0],m=l[1],f=Object(i.b)(),p=function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,I.login({username:n,password:o});case 4:a=e.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(a)),c(""),m(""),f(C(a)),y.setToken(a.token),f(s("".concat(a.name," logged in successfully"),!1)),setTimeout((function(){f({type:"RESET_NOTIFICATION"})}),3e3),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),f(s("wrong credentials",!0)),setTimeout((function(){f({type:"RESET_NOTIFICATION"})}),3e3);case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:p},r.a.createElement(w.a.Group,null,r.a.createElement(w.a.Label,null,"username"),r.a.createElement(w.a.Control,{type:"text",value:n,name:"Username",onChange:function(e){return c(e.target.value)}}),r.a.createElement(w.a.Label,null,"password"),r.a.createElement(w.a.Control,{type:"password",value:o,name:"Password",onChange:function(e){return m(e.target.value)}}),r.a.createElement(k.a,{variant:"primary",type:"submit"},"login")))},N=function(e){var t=e.children,n=e.showButtonLabel,c=e.hideButtonLabel,u=Object(a.useState)(!1),l=Object(j.a)(u,2),o=l[0],i=l[1],s={display:o?"none":""},m={display:o?"":"none"},f=function(){return i(!o)};return r.a.createElement("div",null,r.a.createElement("div",{style:s},r.a.createElement(k.a,{onClick:f},n)),r.a.createElement("div",{style:m},t,"cancel"===c?r.a.createElement(k.a,{variant:"secondary",onClick:f},c):r.a.createElement("button",{onClick:f},c)))},_=n(18),B=n(110),A=function(){var e=Object(i.c)((function(e){return e.blogs})).sort((function(e,t){return t.likes-e.likes}));return r.a.createElement("div",null,r.a.createElement(B.a,{striped:!0},r.a.createElement("tbody",null,e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(_.b,{to:"/blogs/".concat(e.id)},e.title)),r.a.createElement("td",null,e.author))})))))},U=n(111),G=n(67),R=n(66),D=n(9),z=function(){var e=Object(D.g)().blogId,t=Object(i.b)(),n=Object(D.f)(),a=Object(i.c)((function(t){return t.blogs.find((function(t){return t.id===e}))})),c=Object(i.c)((function(e){return e.user}));if(!a)return null;return r.a.createElement("div",null,r.a.createElement("h2",null,a.title," ",a.author),r.a.createElement("a",{href:a.url},a.url),r.a.createElement("div",null,"likes ",a.likes," ",r.a.createElement(k.a,{size:"sm",onClick:function(){var e=Object(f.a)({},a,{likes:a.likes+1});t(function(e){var t=e.id,n=Object(p.a)(e,["id"]);return(function(){var e=Object(b.a)(E.a.mark((function e(a){var r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.update(t,n);case 2:r=e.sent,a({type:"UPDATE_BLOG",data:Object(f.a)({},r,{user:n.user})});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}(e))}},"like")),r.a.createElement("div",null,"added by ",a.user.username),c.username===a.user.username?r.a.createElement(k.a,{variant:"danger",size:"sm",onClick:function(){var e;window.confirm("Remove blog ".concat(a.title))&&(t((e=a.id,function(){var t=Object(b.a)(E.a.mark((function t(n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.remove(e);case 2:n({type:"DELETE_BLOG",data:{id:e}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),n.push("/blogs"))}},"delete"):null,r.a.createElement("h3",null,"Comments"),r.a.createElement(w.a,{onSubmit:function(e){e.preventDefault();var n=e.target.comment.value;t(function(e,t){return function(){var n=Object(b.a)(E.a.mark((function n(a){var r;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y.comment(e.id,t);case 2:r=n.sent,a({type:"UPDATE_BLOG",data:Object(f.a)({},r,{user:e.user})});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(a,n)),e.target.comment.value=""}},r.a.createElement(w.a.Group,null,r.a.createElement(U.a,null,r.a.createElement(G.a,null,r.a.createElement(R.a,{as:"textarea",type:"",name:"comment",size:"sm"})),r.a.createElement(G.a,null,r.a.createElement(k.a,{type:"submit"},"add comment"))))),r.a.createElement("ul",null,a.comments&&a.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},F=function(){return h.a.get("/api/users").then((function(e){return e.data}))},J=function(){var e=Object(i.c)((function(e){return e.users}));return r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"blogs created"))),r.a.createElement("tbody",null,e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(_.b,{to:"/users/".concat(e.id)},e.username)," "),r.a.createElement("td",null,e.blogs.length))}))))},P=function(){var e=Object(D.g)().userId,t=Object(i.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return t?r.a.createElement("div",null,r.a.createElement("h2",null,t.username),r.a.createElement("h3",null,"added blogs"),r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(_.b,{to:"/blogs/".concat(e.id)},e.title))})))):null},M=n(114),V=n(115),W=n(112),q=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.user})),n={padding:"5px"};return r.a.createElement(M.a,{collapseOnSelect:!0,expand:"lg",bg:"light"},r.a.createElement(M.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement(M.a.Collapse,{id:"responsive-navbar-nav"},r.a.createElement(V.a,{className:"mr-auto"},r.a.createElement(V.a.Link,{href:"#",as:"span"},r.a.createElement(_.b,{style:n,to:"/blogs"},"blogs")),r.a.createElement(V.a.Link,{href:"#",as:"span"},r.a.createElement(_.b,{style:n,to:"/users"},"users")),r.a.createElement(W.a,{id:"dropdown-nav-user",title:"".concat(t.username," logged in")},r.a.createElement(W.a.Item,{href:"/login",onClick:function(t){t.preventDefault(),window.localStorage.clear("loggedBlogAppUser"),e({type:"REMOVE_USER"})}},"logout")))))},H=function(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.b)();return Object(a.useEffect)((function(){t(function(){var e=Object(b.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t(function(){var e=Object(b.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:n=e.sent,t({type:"INIT_USERS",data:{users:n}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var n=JSON.parse(e);t(C(n)),y.setToken(n.token)}}),[t]),r.a.createElement("div",{className:"container"},r.a.createElement(T,null),r.a.createElement(_.a,null,null===e?r.a.createElement(L,null):r.a.createElement("div",null,r.a.createElement(q,null),r.a.createElement("h2",null,"blogs app"),r.a.createElement(D.c,null,r.a.createElement(D.a,{path:"/users/:userId"},r.a.createElement(P,null)),r.a.createElement(D.a,{path:"/users"},r.a.createElement("h2",null,"Users"),r.a.createElement(J,null)),r.a.createElement(D.a,{path:"/blogs/:blogId"},r.a.createElement(z,null)),r.a.createElement(D.a,{path:"/"},r.a.createElement(N,{showButtonLabel:"create new blog",hideButtonLabel:"cancel"},r.a.createElement(x,null)),r.a.createElement(A,{user:e}))))))},K=(n(104),Object(l.b)({notification:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.data;switch(n){case"SET_NOTIFICATION":return{notification:a.notification,error:a.error};case"RESET_NOTIFICATION":return{};default:return e}},blogs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.data;switch(n){case"INIT_BLOGS":return a;case"NEW_BLOG":return[].concat(Object(m.a)(e),[a]);case"UPDATE_BLOG":return e.map((function(e){return e.id===a.id?a:e}));case"DELETE_BLOG":return e.filter((function(e){return e.id!==a.id}));default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.data;switch(n){case"SET_USER":return a.user;case"REMOVE_USER":return null;default:return e}},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.data;switch(n){case"INIT_USERS":return a.users;default:return e}}})),Q=Object(l.c)(K,Object(l.a)(o.a));u.a.render(r.a.createElement(i.a,{store:Q},r.a.createElement(H,null)),document.getElementById("root"))},72:function(e,t,n){e.exports=n(105)}},[[72,1,2]]]);
//# sourceMappingURL=main.324215a9.chunk.js.map